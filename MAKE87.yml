version: 1
interfaces:
  - name: ros
    protocol: zenoh
    default_port:
      name: zenoh
      protocol: TCP
      target_port: 7447
    publishers:
      - name: camera_frames
        spec:
          string: ros2.sensor_msgs.msg.Image
        encoding: cdr
config:
  type: object
  properties:
    camera_name:
      type: string
      description: Optional label or ID for the camera (defaults to camera_ip if not set)
    camera_ip:
      type: string
      description: IP address or hostname of the camera
    camera_port:
      type: integer
      description: RTSP port of the camera
      default: 554
    camera_path:
      type: string
      description: RTSP URI path or suffix for the camera
      default: "/"
    camera_username:
      type: string
      description: Username for the camera (optional)
      default: null
    camera_password:
      type: string
      description: Password for the camera (optional, only if username is set)
      default: null
  required:
    - camera_ip
container_config:
  environment:
    ROS_DOMAIN_ID: 87
  volumes:
    - /etc/localtime:/etc/localtime:ro
build:
  custom:
    dockerfile: build_kit/Dockerfile
dev_build:
  custom:
    dockerfile: build_kit/Dockerfile.dev
    build_additions:
      ssh: ssh_server
variants:
  jpeg:
    interfaces:
      - name: ros
        protocol: zenoh
        default_port:
          name: zenoh
          protocol: TCP
          target_port: 7447
        publishers:
          - name: camera_frames
            spec:
              string: ros2.sensor_msgs.msg.CompressedImage
            encoding: cdr
    build:
      custom:
        dockerfile: build_kit/Dockerfile
        args:
          ENABLE_JPEG_COMPRESSION: "ON"
    dev_build:
      custom:
        dockerfile: build_kit/Dockerfile.dev
        args:
          ENABLE_JPEG_COMPRESSION: "ON"
        build_additions:
          ssh: ssh_server
